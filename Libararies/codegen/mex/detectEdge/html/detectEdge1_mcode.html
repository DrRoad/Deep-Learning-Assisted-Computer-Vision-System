<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">edgedRegion</span>] = detectEdge(<span class="var type1" id="S3T1U6">graySImg</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">detectEdge: Edge detection using Sobel Filter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">STEPS</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">1. Check to know if image is coloured (Input should be an RGB image)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">2. If coloured, convert to GrayScale</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">3. Convolve sobel filter with image</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">4. Get gradiaent magnitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">5. perform max and median filtering</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">   Created on: 19th June, 2017</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">   Author: Oluwole Oyetoke Jnr</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">   Using MATLAB 2016</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%Input Validation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%if nargin ~= 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%    error('detectEdge:Input_Argument_Error','This function works with 1 input argument -img- ')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%Declare Filters</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="mxinfo " id="T2:U3"><span class="var type1" id="S4T2U9">Gx</span> = <span class="mxinfo " id="T2:U5">[<span class="mxinfo " id="T3:U6"><span class="mxinfo " id="T4:U7">-<span class="mxinfo " id="T4:U8">1</span></span> <span class="mxinfo " id="T4:U9">0</span> <span class="mxinfo " id="T4:U10">1</span></span>; <span class="mxinfo " id="T3:U11"><span class="mxinfo " id="T4:U12">-<span class="mxinfo " id="T4:U13">2</span></span> <span class="mxinfo " id="T4:U14">0</span> <span class="mxinfo " id="T4:U15">2</span></span>; <span class="mxinfo " id="T3:U16"><span class="mxinfo " id="T4:U17">-<span class="mxinfo " id="T4:U18">1</span></span> <span class="mxinfo " id="T4:U19">0</span> <span class="mxinfo " id="T4:U20">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo " id="T2:U21"><span class="var type1" id="S5T2U28">Gy</span> = <span class="mxinfo " id="T2:U23">[<span class="mxinfo " id="T3:U24"><span class="mxinfo " id="T4:U25">1</span> <span class="mxinfo " id="T4:U26">2</span> <span class="mxinfo " id="T4:U27">1</span></span>; <span class="mxinfo " id="T3:U28"><span class="mxinfo " id="T4:U29">0</span> <span class="mxinfo " id="T4:U30">0</span> <span class="mxinfo " id="T4:U31">0</span></span>;<span class="mxinfo " id="T3:U32"><span class="mxinfo " id="T4:U33">-<span class="mxinfo " id="T4:U34">1</span></span> <span class="mxinfo " id="T4:U35">-<span class="mxinfo " id="T4:U36">2</span></span> <span class="mxinfo " id="T4:U37">-<span class="mxinfo " id="T4:U38">1</span></span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment"><span class="comment">%Check if image is coloured</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">[xDim, yDim, zDim] = size(img);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">img = im2double(img); <span class="comment">%Convert to class double</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">if (zDim&gt;1) <span class="comment">%Convert image to grey scale</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment"><span class="comment">%graySImg = double(rgb2gray(img)); %Automatic way</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">graySImg = (1/3)* ((double(img(:,:,1))) + (double(img(:,:,2)))+ (double(img(:,:,3)))); <span class="comment">%Manual</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">    graySImg = img;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo " id="T4:U39">[<span class="var type1" id="S6T4U48">xDim</span>, <span class="var type1" id="S7T4U49">yDim</span>, <span class="var type1" id="S8T4U50">zDim</span>] = size(<span class="var type1" id="S3T1U53">graySImg</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%Initialize aprameters and variables</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo " id="T4:U44"><span class="var type1" id="S10T4U56">windowSize</span> = <span class="mxinfo " id="T4:U46">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo " id="T4:U47"><span class="var type1" id="S11T4U60">stepSize</span> = <span class="mxinfo " id="T4:U49">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo " id="T4:U50"><span class="var type1" id="S12T4U64">startX</span> = <span class="mxinfo " id="T4:U52">1</span></span>; <span class="mxinfo " id="T4:U53"><span class="var type1" id="S13T4U68">startY</span> = <span class="mxinfo " id="T4:U55">1</span></span>; <span class="mxinfo " id="T4:U56"><span class="var type1" id="S14T4U72">stopX</span> = <span class="var type1" id="S10T4U73">windowSize</span></span>; <span class="mxinfo " id="T4:U59"><span class="var type1" id="S15T4U76">stopY</span> = <span class="var type1" id="S10T4U77">windowSize</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo " id="T4:U62"><span class="var type1" id="S16T4U80">xBlocks</span> = <span class="mxinfo " id="T4:U64">(<span class="mxinfo " id="T4:U65">(<span class="mxinfo " id="T4:U66"><span class="var type1" id="S6T4U86">xDim</span>-<span class="var type1" id="S10T4U87">windowSize</span></span>)/<span class="var type1" id="S11T4U88">stepSize</span></span>)+<span class="mxinfo " id="T4:U70">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="mxinfo " id="T4:U71"><span class="var type1" id="S17T4U92">yBlocks</span> = <span class="mxinfo " id="T4:U73">(<span class="mxinfo " id="T4:U74">(<span class="mxinfo " id="T4:U75"><span class="var type1" id="S7T4U98">yDim</span>-<span class="var type1" id="S10T4U99">windowSize</span></span>)/<span class="var type1" id="S11T4U100">stepSize</span></span>)+<span class="mxinfo " id="T4:U79">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo " id="T4:U80"><span class="var type1" id="S18T4U104">xCounter</span>=<span class="mxinfo " id="T4:U82">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="mxinfo " id="T4:U83"><span class="var type1" id="S19T4U108">yCounter</span>=<span class="mxinfo " id="T4:U85">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo " id="T4:U86"><span class="var type1" id="S20T4U112">totalBlocks</span> = <span class="mxinfo " id="T4:U88"><span class="var type1" id="S16T4U114">xBlocks</span> * <span class="var type1" id="S17T4U115">yBlocks</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo " id="T1:U91"><span class="var type1" id="S21T1U118">edgedImage</span> = <span class="mxinfo " id="T1:U93">zeros(<span class="var type1" id="S16T4U121">xBlocks</span>,<span class="var type1" id="S17T4U122">yBlocks</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T4:U96"><span class="var type1" id="S23T4U125">GxVal</span>=<span class="mxinfo " id="T4:U98">0</span></span>; <span class="mxinfo " id="T4:U99"><span class="var type1" id="S24T4U129">GyVal</span>=<span class="mxinfo " id="T4:U101">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo " id="T4:U102"><span class="var type1" id="S25T4U133">regionGxSum</span>=<span class="mxinfo " id="T4:U104">0</span></span>; <span class="mxinfo " id="T4:U105"><span class="var type1" id="S26T4U137">regionGySum</span>=<span class="mxinfo " id="T4:U107">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%Convolve filter with image</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S27T4U141">loopCount</span> = <span class="mxinfo " id="T4:U109">1</span>:<span class="var type1" id="S20T4U144">totalBlocks</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">      <span class="comment">%Pixel Sum Pooling happens here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">     <span class="mxinfo " id="T4:U111"><span class="var type1" id="S23T4U147">GxVal</span>=<span class="mxinfo " id="T4:U113">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">     <span class="mxinfo " id="T4:U114"><span class="var type1" id="S24T4U151">GyVal</span>=<span class="mxinfo " id="T4:U116">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">     <span class="mxinfo " id="T4:U117"><span class="var type1" id="S25T4U155">regionGxSum</span>=<span class="mxinfo " id="T4:U119">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">     <span class="mxinfo " id="T4:U120"><span class="var type1" id="S26T4U159">regionGySum</span>=<span class="mxinfo " id="T4:U122">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">     <span class="comment">%Try to unroll this loop later (if speed needs arises)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">     <span class="keyword">for</span> <span class="var type1" id="S28T4U163">innerX</span>=<span class="var type1" id="S12T4U166">startX</span>:<span class="mxinfo " id="T4:U125">1</span>:<span class="var type1" id="S14T4U168">stopX</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S29T4U171">innerY</span> =<span class="var type1" id="S13T4U174">startY</span>:<span class="mxinfo " id="T4:U129">1</span>:<span class="var type1" id="S15T4U176">stopY</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">            <span class="mxinfo " id="T4:U131"><span class="var type1" id="S23T4U179">GxVal</span> = <span class="mxinfo " id="T4:U133"><span class="mxinfo " id="T4:U134"><span class="var type1" id="S3T1U182">graySImg</span>(<span class="var type1" id="S28T4U183">innerX</span>, <span class="var type1" id="S29T4U184">innerY</span>)</span> * <span class="mxinfo " id="T4:U138"><span class="var type1" id="S4T2U186">Gx</span>((<span class="mxinfo " id="T4:U140"><span class="mxinfo " id="T4:U141"><span class="var type1" id="S28T4U190">innerX</span>-<span class="var type1" id="S12T4U191">startX</span></span>+<span class="mxinfo " id="T4:U144">1</span></span>),(<span class="mxinfo " id="T4:U145"><span class="mxinfo " id="T4:U146"><span class="var type1" id="S29T4U196">innerY</span>-<span class="var type1" id="S13T4U197">startY</span></span>+<span class="mxinfo " id="T4:U149">1</span></span>))</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">            <span class="mxinfo " id="T4:U150"><span class="var type1" id="S24T4U201">GyVal</span> = <span class="mxinfo " id="T4:U152"><span class="mxinfo " id="T4:U153"><span class="var type1" id="S3T1U204">graySImg</span>(<span class="var type1" id="S28T4U205">innerX</span>, <span class="var type1" id="S29T4U206">innerY</span>)</span> * <span class="mxinfo " id="T4:U157"><span class="var type1" id="S5T2U208">Gy</span>((<span class="mxinfo " id="T4:U159"><span class="mxinfo " id="T4:U160"><span class="var type1" id="S28T4U212">innerX</span>-<span class="var type1" id="S12T4U213">startX</span></span>+<span class="mxinfo " id="T4:U163">1</span></span>),(<span class="mxinfo " id="T4:U164"><span class="mxinfo " id="T4:U165"><span class="var type1" id="S29T4U218">innerY</span>-<span class="var type1" id="S13T4U219">startY</span></span>+<span class="mxinfo " id="T4:U168">1</span></span>))</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">             <span class="mxinfo " id="T4:U169"><span class="var type1" id="S25T4U223">regionGxSum</span> = <span class="mxinfo " id="T4:U171"><span class="var type1" id="S25T4U225">regionGxSum</span>+<span class="var type1" id="S23T4U226">GxVal</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">             <span class="mxinfo " id="T4:U174"><span class="var type1" id="S26T4U229">regionGySum</span> = <span class="mxinfo " id="T4:U176"><span class="var type1" id="S26T4U231">regionGySum</span>+<span class="var type1" id="S24T4U232">GyVal</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%To view window as it slides over the image. Press space bar to release pause</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%hold on</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">%rectangle('Position',[startX startY 3 3], 'EdgeColor', 'g')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%pause</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">     <span class="comment">%Get Gradiaent Magnitude   </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">     <span class="mxinfo " id="T4:U179"><span class="var type1" id="S30T4U235">gradientMag</span> = <span class="mxinfo " id="T4:U181">sqrt(<span class="mxinfo " id="T4:U182">(<span class="mxinfo " id="T4:U183"><span class="var type1" id="S25T4U241">regionGxSum</span>*<span class="var type1" id="S25T4U242">regionGxSum</span></span>) + (<span class="mxinfo " id="T4:U186"><span class="var type1" id="S26T4U245">regionGySum</span>*<span class="var type1" id="S26T4U246">regionGySum</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">     <span class="mxinfo " id="T4:U189"><span class="mxinfo " id="T4:U190"><span class="var type1" id="S21T1U250">edgedImage</span>(<span class="var type1" id="S18T4U251">xCounter</span>, <span class="var type1" id="S19T4U252">yCounter</span>)</span> = <span class="var type1" id="S30T4U253">gradientMag</span></span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    <span class="comment">%Loop management </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">     <span class="keyword">if</span> <span class="mxinfo " id="T5:U195"><span class="var type1" id="S19T4U257">yCounter</span>==<span class="var type1" id="S17T4U258">yBlocks</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">        <span class="comment">%reset xStart, xStop positions and xCounter </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">         <span class="mxinfo " id="T4:U198"><span class="var type1" id="S13T4U261">startY</span> = <span class="mxinfo " id="T4:U200">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">         <span class="mxinfo " id="T4:U201"><span class="var type1" id="S15T4U265">stopY</span> = <span class="var type1" id="S10T4U266">windowSize</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">         <span class="mxinfo " id="T4:U204"><span class="var type1" id="S19T4U269">yCounter</span>=<span class="mxinfo " id="T4:U206">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">         <span class="mxinfo " id="T4:U207"><span class="var type1" id="S18T4U273">xCounter</span> = <span class="mxinfo " id="T4:U209"><span class="var type1" id="S18T4U275">xCounter</span>+<span class="mxinfo " id="T4:U211">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">         </span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">         <span class="mxinfo " id="T4:U212"><span class="var type1" id="S12T4U279">startX</span>=<span class="mxinfo " id="T4:U214"><span class="var type1" id="S12T4U281">startX</span>+<span class="var type1" id="S11T4U282">stepSize</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">         <span class="mxinfo " id="T4:U217"><span class="var type1" id="S14T4U285">stopX</span>=<span class="mxinfo " id="T4:U219"><span class="mxinfo " id="T4:U220"><span class="var type1" id="S12T4U288">startX</span>+<span class="var type1" id="S10T4U289">windowSize</span></span>-<span class="mxinfo " id="T4:U223">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">     <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">       <span class="mxinfo " id="T4:U224"><span class="var type1" id="S13T4U294">startY</span> = <span class="mxinfo " id="T4:U226"><span class="var type1" id="S13T4U296">startY</span>+<span class="var type1" id="S11T4U297">stepSize</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">       <span class="mxinfo " id="T4:U229"><span class="var type1" id="S15T4U300">stopY</span> = <span class="mxinfo " id="T4:U231"><span class="mxinfo " id="T4:U232"><span class="var type1" id="S13T4U303">startY</span>+<span class="var type1" id="S10T4U304">windowSize</span></span>-<span class="mxinfo " id="T4:U235">1</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">           <span class="mxinfo " id="T4:U236"><span class="var type1" id="S19T4U308">yCounter</span>=<span class="mxinfo " id="T4:U238"><span class="var type1" id="S19T4U310">yCounter</span>+<span class="mxinfo " id="T4:U240">1</span></span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="keyword">end</span> <span class="comment">%end of xLoopCount</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="comment">%Filter image using max and median filter to detect just mostly edges and wipe out negatives</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="mxinfo " id="T4:U241"><span class="var type1" id="S32T4U314">medianVal</span> = (<span class="mxinfo " id="T4:U243">median(<span class="mxinfo " id="T6:U244">median(<span class="mxinfo " id="T1:U245"><span class="var type1" id="S21T1U321">edgedImage</span>(<span class="mxinfo " id="T7:U247">:</span>,<span class="mxinfo " id="T7:U248">:</span>)</span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="mxinfo " id="T4:U249"><span class="var type1" id="S34T4U326">maxVal</span> = (<span class="mxinfo " id="T4:U251">max(<span class="mxinfo " id="T6:U252">max(<span class="mxinfo " id="T1:U253"><span class="var type1" id="S21T1U333">edgedImage</span>(<span class="mxinfo " id="T7:U255">:</span>,<span class="mxinfo " id="T7:U256">:</span>)</span>)</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo " id="T1:U257"><span class="var type1" id="S36T1U338">filteredEdgeImage</span> = <span class="mxinfo " id="T1:U259"><span class="var type1" id="S21T1U340">edgedImage</span>-<span class="var type1" id="S32T4U341">medianVal</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo " id="T4:U262"><span class="var type1" id="S37T4U344">Thresh</span> = <span class="mxinfo " id="T4:U264"><span class="var type1" id="S34T4U346">maxVal</span>*<span class="mxinfo " id="T4:U266">0.3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="comment">%Black out all place where edge image is &lt;30% of the brightes pixel in the picture</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo " id="T8:U267"><span class="mxinfo " id="T8:U268"><span class="var type1" id="S36T1U351">filteredEdgeImage</span>( <span class="mxinfo " id="T9:U270"><span class="var type1" id="S36T1U353">filteredEdgeImage</span>&lt;<span class="var type1" id="S37T4U354">Thresh</span></span>)</span>=<span class="mxinfo " id="T4:U273">0</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo " id="T1:U274"><span class="var type1" id="S2T1U358">edgedRegion</span> = <span class="var type1" id="S36T1U359">filteredEdgeImage</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"><span class="comment">%fprintf('Edge Detection Carried Out')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="comment">%imshow(edgedRegion)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"><span class="keyword">end</span> <span class="comment">%end of module</span></span></span>
</pre>
